<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>page course</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ysabeau+Infant:ital,wght@0,1..1000;1,1..1000&display=swap"
          rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/style/style.css}" rel="stylesheet">
    <link th:href="@{/style/pageCourse.css}" rel="stylesheet">
</head>
<body>
<!--Верхнее меню-->
<header>
    <div class="logo">
        <img th:src="@{/images/logo.svg}" alt="logo" class="logo__img">
        <p>Школа китайского языка</p>
    </div>
    <nav id="menu">
        <ul class="menu">
            <li><a th:href="@{/user}">Личный кабинет</a></li>
            <li><a th:href="@{/courses}">Курсы</a></li>
        </ul>
    </nav>
</header>

<section id="edit-course" class="container">
    <form th:action="${isPresent} ? '/courses/' + ${courseInfo.id} + '/edit': '/courses/new'" method="post" th:object="${courseInfo}">
        <div class="block description">
            <ul>
                <li>
                    <label for="name">Название</label>
                    <input type="text" id="name" placeholder="Название" class="input"
                           th:field="${courseInfo.courseName}">
                </li>

                <li>
                    <label for="levels">Сложность</label>

                    <select id="levels" name="levels" th:field="${courseInfo.difficulty}" class="input">
                        <option th:each="difficulty :${difficulties}"
                                th:value="${difficulty}"
                                th:text="${difficulty}"
                                th:selected="${courseInfo.difficulty == difficulty}"></option>
                    </select>

                </li>

                <li>
                    <label for="description">Описание</label>
                    <textarea id="description" name="description" rows="4" cols="50" placeholder="Описание"
                              class="input" th:field="*{description}" required></textarea>
                    <!--                <input id="description" type="description" placeholder="Описание">-->
                </li>

            </ul>


            <div class="edit-course__button">
                <button class="button">Сохранить</button>
            </div>

            <div class="edit-course__button">
                <button class="button" onclick="window.location.href='/courses'">Отмена</button>
            </div>

        </div>
    </form>

    <div class="buttons-edits-remove">
        <button class="course__button delete" th:if="${isPresent}" th:onclick="'deleteCourse(\'' + ${courseInfo.id} + '\')'">Удалить курс</button>
        <script th:inline="javascript">
            /*<![CDATA[*/
            var courseId = /*[[${courseInfo.id}]]*/ '';
            /*]]>*/
        </script>
        <button class="course__button change" onclick="window.location.href='/courses/' + courseId + '/settings'">Изменить состав</button>

    </div>

    <script>
        function deleteCourse(courseId) {
            console.log('Удаляем курс с ID:', courseId);
            if (confirm('Вы уверены, что хотите удалить курс?')) {
                console.log('Курс будет удален. Перенаправляем пользователя...');
                fetch('/courses/' + courseId + '/delete', {
                    method: 'POST'
                })
                    .then(response =>{
                        window.location.href = '/courses';
                    })
            } else {
                console.log('Пользователь отменил удаление курса.');
            }
        }
    </script>

</section>

</body>
</html>